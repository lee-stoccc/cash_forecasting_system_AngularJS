(function(){angular.module("devplatformApp").controller("TermInfoController",a);a.$inject=["$rootScope","FcPublicService","TermInfoService","ngDialog","$state","$scope","PublicService","SysDictService","BankRuleService","globalConstant","Upload","$stateParams","$translate"];function a(m,r,g,o,c,p,i,l,h,j,f,n,d){p.formParam={status:"",bankId:n.bankId};p.tablesConfig={showCheckBox:true,checkOneAction:"checkOneAction",checkAllAction:"checkAllAction",tableTitles:[{title:"termInfo.termNo",filed:"termNo",type:"text",Width:5,tipTitle:"Terminal ID"},{title:"termInfo.bankName",filed:"bankName",type:"text",width:18,tipTitle:"Brank Name"},{title:"termInfo.branchNo",filed:"branchName",type:"text",width:7,tipTitle:"Brank Code"},{title:"termInfo.holidayAdd",filed:"holidayAdd",type:"text",width:7,tipTitle:"Holiday Add"},{title:"termInfo.replenishRule",filed:"replenishRule",type:"text",width:8,tipTitle:"ReplenishRule"},{title:"termInfo.indCashSecurity",filed:"indCashSecurity",type:"text",width:8,tipTitle:"IndCashSecurity"},{title:"termInfo.escort",filed:"escortName",type:"text",width:5,tipTitle:"Escort"},{title:"termInfo.status",filed:"status",type:"text",width:5,tipTitle:"Status"},],url:"api/termInfo/page",formParams:{termNo:p.formParam.termNo,cusTermNo:p.formParam.cusTermNo,cusRegionId:p.formParam.cusRegionId,bankId:p.formParam.bankId,branchNo:p.formParam.branchNo,status:p.formParam.status,escort:p.formParam.escort}};p.checkOneAction=function(s){p.choseArr=[];angular.forEach(s,function(t){if(t.checked){p.choseArr.push(t)}})};p.checkAllAction=function(s){p.choseArr=[];angular.forEach(s,function(t){if(t.checked){p.choseArr.push(t)}})};p.init=function(){e("termStatusList","forecast.termStatus");e("escortList","forecast.escort");e("branchList","forecast.branch");q();p.initData()};p.initData=function(){p.select("#bankNameTerm");p.select("#cusRegionTerm");p.select("#branchNameTerm");p.select("#statusTerm");p.select("#escortTerm")};function b(t){var s=document.getElementById(t);return s}p.select=function(s){angular.element(s).select2({placeholder:d.instant("global.pleaseSelect"),allowClear:true,tags:false})};function e(t,s){l.getDictListAsync(s).then(function(u){if(u.statusCode==="0000"){p[t]=u.data}})}function k(){r.getCusgionList().then(function(s){if(s.statusCode==="0000"){p.cusgionList=s.data}})}p.bankTermInfoSelectCheck=function(s){};p.bankTermInfoSelectItem=function(s){};function q(){p.showCheckBox=true;r.getBanksList().then(function(s){if(s.statusCode==="0000"){p.bankList=s.data}})}p.loadAll=function(){p.refreshTableList(p.formParam)};p.resetSearch=function(){p.formParam={status:"1"};p.bankName="";q();p.init()};p.addTermInfo=function(){c.go("app.termInfo-edit",{id:""})};p.editTermInfo=function(){if(p.choseArr.length!=1){var s="global.chooseOneEdit";i.openDialog(s);return}else{var t=p.choseArr[0]["id"];c.go("app.termInfo-edit",{id:t})}};p.batchEdit=function(){if(i.isEmptyObject(p.choseArr[0])){var s="global.selectEdit";i.openDialog(s);return}c.go("app.batch-edit",{ids:p.checked})};p.importExcel=function(s){var t=j.devplatform_web_apiPath+"api/termInfo/importExcel";i.submitFile(s,t,"loadAll",p)};p.importSettingExcel=function(s){var t=j.devplatform_web_apiPath+"api/termInfo/batchImportAdjustment";i.submitFile(s,t,"loadAll",p)};p.upLoadTempFile=function(t){var s=j.devplatform_web_apiPath+"api/termInfo/uploadTemplate";i.submitFile(t,s)};p.downLoadFile=function(){g.downLoadFile()};p.batchDelete=function(){var s="";if(i.isEmptyObject(p.choseArr[0])){s="global.selectDelete";i.openDialog(s);return}s="global.messages.deleteConfirm";i.showConfirmDialog(s,"confirmDelete",p,p.checked)};p.confirmDelete=function(s){g.deleteTermInfo(s).then(function(t){if(t.statusCode==="0000"){p.loadAll();var u="global.messages.deleteSuccess";i.openDialog(u)}})};p.showTermInfo=function(s){c.go("app.termInfo-detail",{id:s})};m.$on("termInfoEdit",function(s,t){p.loadAll()})}})();