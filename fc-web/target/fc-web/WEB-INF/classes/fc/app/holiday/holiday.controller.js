(function(){angular.module("devplatformApp").controller("HolidayController",a);a.$inject=["$rootScope","FcPublicService","HolidayService","ngDialog","$state","$scope","PublicService","$window"];function a(h,k,g,i,b,j,f,d){j.abc=g.abc;var c=dateToGMT(new Date().getFullYear()+"-01-01T00:00:00.000+0800");var e=dateToGMT(new Date().getFullYear()+"-12-31T00:00:00.000+0800");j.formParam={startTime:c,endTime:e,dates:c+"-"+e};j.datePickerOpenStatus={};j.choseArr=[];j.tablesConfig={checkOneAction:"checkOneAction",checkAllAction:"checkAllAction",showCheckBox:true,tableTitles:[{title:"holiday.year",filed:"year",type:"text",width:8,tipTitle:"Year"},{title:"holiday.date",filed:"details",type:"holiday_date",width:30,tipTitle:"Holiday"},{title:"holiday.supplement",filed:"details",type:"supplement_date",width:30,tipTitle:"Supplement"},{title:"holiday.holidayName",filed:"holidayName",type:"text",width:20,tipTitle:"HolidayName"},],url:"api/holiday/page",formParams:{startTime:j.formParam.startTime,endTime:j.formParam.endTime,holidayName:j.formParam.holidayName,dates:j.formParam.dates}};j.init=function(){};j.changClassTime=function(){setTimeout(function(){var n=j.tableList;for(var q=0;q<n.length;q++){for(var p=0;p<n[q]["details"].length;p++){if(n[q]["details"][p]["type"]==1){var m=n[q]["details"][p]["startDate"];var o=m.indexOf("T");var l=m.substring(0,o);var s=n[q]["details"][p]["endDate"];var t=s.indexOf("T");var r=s.substring(0,t);j.tableList[q]["dates"]=l+"~"+r}else{var m=n[q]["details"][p]["startDate"];var o=m.indexOf("T");var l=m.substring(0,o);var s=n[q]["details"][p]["endDate"];var t=s.indexOf("T");var r=s.substring(0,t);j.tableList[q]["supplements"]=l+"~"+r}}}},500)};j.checkOneAction=function(l){j.choseArr=[];angular.forEach(l,function(m){if(m.checked){j.choseArr.push(m)}})};j.checkAllAction=function(l){j.choseArr=[];angular.forEach(l,function(m){if(m.checked){j.choseArr.push(m)}})};j.loadAll=function(){j.refreshTableList(j.formParam)};j.resetSearch=function(){j.formParam={}};j.openCalendar=function(l){j.datePickerOpenStatus[l]=true};j.checkStartTime=function(){if(j.formParam.startTime>j.formParam.endTime){var l="global.timeMsg1";f.openDialog(l);j.formParam.startTime=undefined}};j.checkEndTime=function(){if(j.formParam.startTime>j.formParam.endTime){var l="global.timeMsg2";f.openDialog(l);j.formParam.endTime=undefined}};j.addHoliday=function(){b.go("app.holiday-edit",{id:""})};j.editHoliday=function(){j.choseArr=j.getCheckValues("delFlag").check;if(j.choseArr.length!=1){var l="global.chooseOneEdit";f.openDialog(l);return}else{var m=j.choseArr[0];b.go("app.holiday-edit",{id:m})}};j.batchDelete=function(){j.choseArr=j.getCheckValues("delFlag").check;var l="";if(f.isEmptyObject(j.choseArr[0])){l="global.selectDelete";f.openDialog(l);return}l="global.messages.deleteConfirm";f.showConfirmDialog(l,"confirmDelete",j,j.checked)};j.confirmDelete=function(l){g.deleteHoliday(l).then(function(m){if(m.statusCode==="0000"){j.loadAll();var n="global.messages.deleteSuccess";f.openDialog(n)}})};h.$on("rootEventHoliday",function(l,m){j.loadAll()})}})();