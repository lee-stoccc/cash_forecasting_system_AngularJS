(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(b())})}else{if(typeof exports==="object"){module.exports=b()}else{b()}}}(this,function(){angular.module("tmh.dynamicLocale",[]).config(["$provide",function(b){function a(c){c.$stateful=true;return c}b.decorator("dateFilter",["$delegate",a]);b.decorator("numberFilter",["$delegate",a]);b.decorator("currencyFilter",["$delegate",a])}]).constant("tmhDynamicLocale.STORAGE_KEY","tmhDynamicLocale.locale").provider("tmhDynamicLocale",["tmhDynamicLocale.STORAGE_KEY",function(j){var l,h="angular/i18n/angular-locale_{{locale}}.js",e,c="tmhDynamicLocaleStorageCache",g,i=j,d={},f,k={};function a(o,s,n,q){var m=document.createElement("script"),p=e?e:document.getElementsByTagName("body")[0],r=false;m.type="text/javascript";if(m.readyState){m.onreadystatechange=function(){if(m.readyState==="complete"||m.readyState==="loaded"){m.onreadystatechange=null;q(function(){if(r){return}r=true;p.removeChild(m);s()},30,false)}}}else{m.onload=function(){if(r){return}r=true;p.removeChild(m);s()};m.onerror=function(){if(r){return}r=true;p.removeChild(m);n()}}m.src=o;m.async=true;p.appendChild(m)}function b(q,o,r,s,p,m,n){function v(w,x){if(f!==r){return}angular.forEach(w,function(z,y){if(!x[y]){delete w[y]}else{if(angular.isArray(x[y])){w[y].length=x[y].length}}});angular.forEach(x,function(z,y){if(angular.isArray(x[y])||angular.isObject(x[y])){if(!w[y]){w[y]=angular.isArray(x[y])?[]:{}}v(w[y],x[y])}else{w[y]=x[y]}})}if(d[r]){f=r;return d[r]}var u,t=p.defer();if(r===f){t.resolve(o)}else{if((u=m.get(r))){f=r;s.$evalAsync(function(){v(o,u);g.put(i,r);s.$broadcast("$localeChangeSuccess",r,o);t.resolve(o)})}else{f=r;d[r]=t.promise;a(q,function(){var w=angular.injector(["ngLocale"]),x=w.get("$locale");v(o,x);m.put(r,x);delete d[r];s.$applyAsync(function(){g.put(i,r);s.$broadcast("$localeChangeSuccess",r,o);t.resolve(o)})},function(){delete d[r];s.$applyAsync(function(){if(f===r){f=o.id}s.$broadcast("$localeChangeError",r);t.reject(r)})},n)}}return t.promise}this.localeLocationPattern=function(m){if(m){h=m;return this}else{return h}};this.appendScriptTo=function(m){e=m};this.useStorage=function(m){c=m};this.useCookieStorage=function(){this.useStorage("$cookieStore")};this.defaultLocale=function(m){l=m};this.storageKey=function(m){if(m){i=m;return this}else{return i}};this.addLocalePatternValue=function(m,n){k[m]=n};this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(r,u,q,s,p,o,n){var m=q(h);g=u.get(c);r.$evalAsync(function(){var v;if((v=(g.get(i)||l))){t(v)}});return{set:t,get:function(){return f}};function t(w){var v={locale:w,angularVersion:angular.version.full};return b(m(angular.extend({},k,v)),s,w,r,p,o,n)}}]}]).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop]);return"tmh.dynamicLocale"}));