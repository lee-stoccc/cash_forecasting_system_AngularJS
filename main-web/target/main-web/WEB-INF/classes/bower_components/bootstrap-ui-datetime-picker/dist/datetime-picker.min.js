angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},initialPicker:"date",reOpenDefault:!1,enableDate:!0,enableTime:!0,buttonBar:{show:!0,now:{show:!0,text:"Now"},today:{show:!0,text:"Today"},clear:{show:!0,text:"Clear"},date:{show:!0,text:"Date"},time:{show:!0,text:"Time"},close:{show:!0,text:"Close"}},closeOnDateSelection:!0,closeOnTimeNow:!0,appendToBody:!1,altInputFormats:[],ngModelOptions:{},saveAs:!1,readAs:!1}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function(aj,ai,ah,ag,af,ae,ad,ac,ab,aa,Z,Y){function X(h){var g=J[0],b=ai[0].contains(h.target),a=void 0!==g.contains&&g.contains(h.target);!aj.isOpen||b||a||aj.$apply(function(){aj.close(!1)})}function W(a){27===a.which&&aj.isOpen?(a.preventDefault(),a.stopPropagation(),aj.$apply(function(){aj.close(!1)}),ai[0].focus()):40!==a.which||aj.isOpen||(a.preventDefault(),a.stopPropagation(),aj.$apply(function(){aj.isOpen=!0}))}function V(b){return b.replace(/([A-Z])/g,function(c){return"-"+c.toLowerCase()})}function U(a){var f=aa.parse(a,I,aj.date);if(isNaN(f)){for(var e=0;e<P.length;e++){if(f=aa.parse(a,P[e],aj.date),!isNaN(f)){return f}}}return f}function S(d){if(angular.isNumber(d)&&!isNaN(d)&&(d=new Date(d)),!d){return null}if(angular.isDate(d)&&!isNaN(d)){return d}if(angular.isString(d)){var c=U(d);if(!isNaN(c)){return aa.toTimezone(c,K.timezone)}}else{}}function Q(a){return aj.datepickerOptions.minDate&&a<aj.datepickerOptions.minDate?!1:!(aj.datepickerOptions.maxDate&&a>aj.datepickerOptions.maxDate)}function O(e,c){var f=e||c;return ah.ngRequired||ah.required||f?(angular.isNumber(f)&&(f=new Date(f)),f?angular.isDate(f)&&!isNaN(f)?Q(f):angular.isDate(new Date(f))&&!isNaN(new Date(f).valueOf())?Q(new Date(f)):angular.isString(f)?!isNaN(U(c))&&Q(U(c)):!1:!0):!0}var M,K,J,I=Z.dateFormat,H={},G=[],F=angular.isDefined(ah.closeOnDateSelection)?aj.$parent.$eval(ah.closeOnDateSelection):Z.closeOnDateSelection,T=angular.isDefined(ah.closeOnTimeNow)?aj.$parent.$eval(ah.closeOnTimeNow):Z.closeOnTimeNow,R=angular.isDefined(ah.datepickerAppendToBody)?aj.$parent.$eval(ah.datepickerAppendToBody):Z.appendToBody,P=angular.isDefined(ah.altInputFormats)?aj.$parent.$eval(ah.altInputFormats):Z.altInputFormats,N=angular.isDefined(ah.saveAs)?aj.$parent.$eval(ah.saveAs)||ah.saveAs:Z.saveAs,L=angular.isDefined(ah.readAs)?aj.$parent.$eval(ah.readAs):Z.readAs;this.init=function(n){function k(g){if(M.$isEmpty(g)){return g}var e=new Date(g);return angular.isDate(e)&&!isNaN(e)?e:g}function f(e){return !e||angular.isString(e)||!angular.isDate(e)||isNaN(e)?e:"ISO"===N?e.toISOString():"json"===N?e.toJSON():"number"===N?e.valueOf():d?aa.fromTimezone(e,K.timezone).toLocaleString():(I=I.replace(/M!/,"MM").replace(/d!/,"dd"),aa.filter(aa.fromTimezone(e,K.timezone),I))}if(M=n,K=M.$options||Z.ngModelOptions,aj.buttonBar=angular.isDefined(ah.buttonBar)?aj.$parent.$eval(ah.buttonBar):Z.buttonBar,aj.enableDate=angular.isDefined(aj.enableDate)?aj.enableDate:Z.enableDate,aj.enableTime=angular.isDefined(aj.enableTime)?aj.enableTime:Z.enableTime,aj.initialPicker=angular.isDefined(ah.initialPicker)?ah.initialPicker:aj.enableDate?Z.initialPicker:"time",aj.reOpenDefault=angular.isDefined(ah.reOpenDefault)?ah.reOpenDefault:Z.reOpenDefault,"date"==aj.initialPicker&&!aj.enableDate){throw new Error("datetimePicker can't have initialPicker set to date and have enableDate set to false.")}aj.showPicker=aj.enableDate?aj.initialPicker:"time";var d=!1;if(Z.html5Types[ah.type]?(I=Z.html5Types[ah.type],d=!0):(I=ah.datetimePicker||Z.dateFormat,ah.$observe("datetimePicker",function(g){var e=g||Z.dateFormat;if(e!==I&&(I=e,M.$modelValue=null,!I)){throw new Error("datetimePicker must have a date format specified.")}})),!I){throw new Error("datetimePicker must have a date format specified.")}var c=angular.element('<div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div>');K?(timezone=K.timezone,aj.ngModelOptions=angular.copy(K),aj.ngModelOptions.timezone=null,aj.ngModelOptions.updateOnDefault===!0&&(aj.ngModelOptions.updateOn=aj.ngModelOptions.updateOn?aj.ngModelOptions.updateOn+" default":"default"),c.attr("ng-model-options","ngModelOptions")):timezone=null,c.attr({"ng-model":"date","ng-change":"dateSelection(date)"});var b=angular.element(c.children()[0]);aj.datepickerOptions||(aj.datepickerOptions={}),d&&"month"===ah.type&&(aj.datepickerOptions.datepickerMode="month",aj.datepickerOptions.minMode="month"),b.attr("datepicker-options","datepickerOptions"),angular.isDefined(aj.datepickerOptions.datepickerMode)||(aj.datepickerOptions.datepickerMode="day");var j=angular.element(c.children()[1]);aj.timepickerOptions||(aj.timepickerOptions={});for(var a in aj.timepickerOptions){j.attr(V(a),"timepickerOptions."+a)}angular.forEach(["minDate","maxDate","initDate"],function(e){aj.datepickerOptions[e]&&("minDate"==e?j.attr("min","datepickerOptions.minDate"):"maxDate"==e&&j.attr("max","datepickerOptions.maxDate"))}),d?M.$formatters.push(function(e){return aj.date=aa.fromTimezone(e,K.timezone),e}):(M.$$parserName="datetime",M.$validators.datetime=O,M.$parsers.unshift(S),M.$formatters.push(function(e){return M.$isEmpty(e)?(aj.date=e,e):(aj.date=aa.fromTimezone(e,K.timezone),I=I.replace(/M!/,"MM").replace(/d!/,"dd"),aa.filter(aj.date,I))})),N&&(angular.isFunction(N)?M.$parsers.push(N):M.$parsers.push(f),angular.isFunction(L)?M.$formatters.push(L):M.$formatters.push(k)),M.$viewChangeListeners.push(function(){aj.date=U(M.$viewValue)}),ai.bind("keydown",W),J=ag(c)(aj),c.remove(),R?ae.find("body").append(J):ai.after(J)},aj.getText=function(a){return aj.buttonBar[a].text||Z.buttonBar[a].text},aj.keydown=function(a){27===a.which&&(aj.close(!1),ai[0].focus())},aj.doShow=function(a){return angular.isDefined(aj.buttonBar[a].show)?aj.buttonBar[a].show:Z.buttonBar[a].show},aj.dateSelection=function(j,i){if(aj.enableTime&&"time"===aj.showPicker&&(j||null!=j)&&(angular.isDefined(aj.date)&&null!=aj.date||(aj.date=new Date),j&&null!=j)){var c=new Date(aj.date);c.setHours(j.getHours()),c.setMinutes(j.getMinutes()),c.setSeconds(j.getSeconds()),c.setMilliseconds(j.getMilliseconds()),j=c}if(angular.isDefined(j)){if(!aj.date){var b=angular.isDefined(ah.defaultTime)?ah.defaultTime:Z.defaultTime,a=new Date("2001-01-01 "+b);isNaN(a)||null==j||(j.setHours(a.getHours()),j.setMinutes(a.getMinutes()),j.setSeconds(a.getSeconds()),j.setMilliseconds(a.getMilliseconds()))}aj.date=j}var c=aj.date?ab(aj.date,I):null;ai.val(c),M.$setViewValue(c),F&&("time"!=aj.showPicker&&null!=c?aj.enableTime?aj.open("time"):aj.close(!1):T&&"time"===aj.showPicker&&null!=c&&"now"===i&&aj.close(!1))},aj.$watch("isOpen",function(b){if(aj.dropdownStyle={display:b?"block":"none"},b){H.openDate=aj.date;var a=R?ac.offset(ai):ac.position(ai);R?aj.dropdownStyle.top=a.top+ai.prop("offsetHeight")+"px":aj.dropdownStyle.top=void 0,aj.dropdownStyle.left=a.left+"px",ad(function(){aj.$broadcast("uib:datepicker.focus"),ae.bind("click",X)},0,!1),aj.open(aj.showPicker)}else{ae.unbind("click",X)}}),aj.isDisabled=function(a){"today"!==a&&"now"!==a||(a=aa.fromTimezone(new Date,timezone));var d={};return angular.forEach(["minDate","maxDate"],function(c){aj.datepickerOptions[c]?angular.isDate(aj.datepickerOptions[c])?d[c]=aa.fromTimezone(new Date(aj.datepickerOptions[c]),timezone):d[c]=new Date(ab(aj.datepickerOptions[c],"medium")):d[c]=null}),aj.datepickerOptions&&d.minDate&&aj.compare(a,d.minDate)<0||d.maxDate&&aj.compare(a,d.maxDate)>0},aj.compare=function(d,c){return new Date(d.getFullYear(),d.getMonth(),d.getDate())-new Date(c.getFullYear(),c.getMonth(),c.getDate())},aj.select=function(a,h){angular.isDefined(h)&&(h.preventDefault(),h.stopPropagation());var g=null;if("today"===a||"now"==a){var f=new Date;angular.isDate(aj.date)?(g=new Date(aj.date),g.setFullYear(f.getFullYear(),f.getMonth(),f.getDate()),g.setHours(f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())):g=f}aj.dateSelection(g,a)},aj.open=function(a,d){angular.isDefined(d)&&(d.preventDefault(),d.stopPropagation()),ad(function(){aj.showPicker=a},0),"time"==a&&ad(function(){aj.date=U(M.$viewValue)},50)},aj.close=function(b,a){angular.isDefined(a)&&(a.preventDefault(),a.stopPropagation()),aj.isOpen=!1,aj.enableDate&&aj.enableTime&&(aj.showPicker=aj.reOpenDefault===!1?"date":aj.reOpenDefault),angular.isDefined(b)?aj.whenClosed({args:{closePressed:b,openDate:H.openDate||null,closeDate:aj.date}}):ai[0].focus()},aj.$on("$destroy",function(){aj.isOpen===!0&&(Y.$$phase||aj.$apply(function(){aj.close()})),G.forEach(function(b){b()}),J.remove(),ai.unbind("keydown",W),ae.unbind("click",X)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",datepickerOptions:"=?",timepickerOptions:"=?",enableDate:"=?",enableTime:"=?",initialPicker:"=?",reOpenDefault:"=?",whenClosed:"&"},link:function(h,g,l,k){var j=k[0],i=k[1];i.init(j)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/time-picker.html"}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(b){b.put("template/date-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'date\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=date-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'today\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'today\')" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'today\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'time\') && enableTime) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'time\') && enableTime" ng-click="open(\'time\', $event)">{{ getText(\'time\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>'),b.put("template/time-picker.html",'<ul class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-if="isOpen && showPicker == \'time\'" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click="$event.preventDefault(); $event.stopPropagation()"><li style="padding:0 5px 5px 5px" class=time-picker-menu><div ng-transclude></div></li><li style=padding:5px ng-if=buttonBar.show><span class="btn-group pull-left" style=margin-right:10px ng-if="doShow(\'now\') || doShow(\'clear\')"><button type=button class="btn btn-sm btn-info" ng-if="doShow(\'now\')" ng-click="select(\'now\', $event)" ng-disabled="isDisabled(\'now\')">{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-if="doShow(\'clear\')" ng-click="select(\'clear\', $event)">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right" ng-if="(doShow(\'date\') && enableDate) || doShow(\'close\')"><button type=button class="btn btn-sm btn-default" ng-if="doShow(\'date\') && enableDate" ng-click="open(\'date\', $event)">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-if="doShow(\'close\')" ng-click="close(true, $event)">{{ getText(\'close\') }}</button></span> <span class=clearfix></span></li></ul>')}]);