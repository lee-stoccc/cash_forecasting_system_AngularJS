(function(){angular.module("devplatformApp").controller("BankRuleController",a);a.$inject=["$rootScope","FcPublicService","BankRuleService","ngDialog","$state","$scope","PublicService","$window","$stateParams","$translate"];function a(g,l,e,i,b,j,f,d,h,c){d.onunload=function(){console.log("刷新一下窗口")};j.formParam={};j.datePickerOpenStatus={};j.choseArr=[];j.tablesConfig={checkOneAction:"checkOneAction",checkAllAction:"checkAllAction",showCheckBox:true,tableTitles:[{title:"bankRule.bankName",filed:"bankName",type:"text-btn",width:20,actions:[{actionName:"showBankRule(item.id)"}]},{title:"bankRule.stockCeiling",filed:"stockCeiling",type:"text",width:8},{title:"bankRule.frequency",filed:"frequency",type:"text",width:6},{title:"bankRule.replenishRule",filed:"replenishRule",type:"text",width:14},{title:"bankRule.holidayAdd",filed:"holidayAdd",type:"text",width:10},{title:"bankRule.indCashSecurit",filed:"indCashSecurity",type:"text",width:10},{title:"bankRule.indCashReturn",filed:"indReplenishCost",type:"text",width:10},{title:"bankRule.unitCount",filed:"unitCount",type:"text",width:10},],url:"api/bankRule/page",formParams:{bankId:j.formParam.bankId,}};j.checkOneAction=function(m){j.choseArr=[];angular.forEach(m,function(n){if(n.checked){j.choseArr.push(n)}})};j.checkAllAction=function(m){j.choseArr=[]};j.init=function(){k();j.select("#bankNoBankRule")};j.select=function(m){angular.element(m).select2({placeholder:c.instant("global.pleaseSelect"),allowClear:true,tags:false})};function k(){j.showCheckBox=false;l.getBanksList().then(function(m){if(m.statusCode==="0000"){j.bankList=m.data}})}j.loadAll=function(){j.refreshTableList(j.formParam)};j.resetSearch=function(){k();j.formParam={};j.bankName=""};j.addBankRule=function(){b.go("app.bankRule-edit",{id:""})};j.showBankRule=function(m){b.go("app.bankRule-detail",{id:m})};j.editBankRule=function(){if(j.choseArr.length!=1){var m="global.chooseOneEdit";f.openDialog(m);return}else{var n=j.choseArr[0]["id"];b.go("app.bankRule-edit",{id:n})}};j.batchDelete=function(){j.choseArr=j.getCheckValues("delFlag").check;var m="";if(f.isEmptyObject(j.choseArr[0])){m="global.selectDelete";f.openDialog(m);return}m="global.messages.deleteConfirm";f.showConfirmDialog(m,"confirmDelete",j,j.checked)};j.confirmDelete=function(m){e.deleteBankRule(m).then(function(n){if(n.statusCode==="0000"){var p="global.messages.deleteSuccess";f.openDialog(p);j.loadAll();if(n.msgCode=="1"){var o="bankRule.showMsg";f.showConfirmDialog(o,"toTermInfoPage",j,m)}}else{f.openDialog(n.msgCode)}})};j.toTermInfoPage=function(m){b.go("app.termInfo",{bankId:m})};g.$on("bankRuleEdit",function(m,n){j.loadAll()})}})();