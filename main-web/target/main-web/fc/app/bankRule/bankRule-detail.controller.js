(function(){angular.module("devplatformApp").controller("BankRuleDetailController",a);a.$inject=["BankRuleService","FcPublicService","$scope","$stateParams","$state","ngDialog","PublicService","$uibModalInstance","$translate","SysDictService"];function a(f,o,m,l,b,j,g,k,c,i){m.replenishRule=[{value:c.instant("bankRule.Monday"),key:1},{value:c.instant("bankRule.Tuesday"),key:2},{value:c.instant("bankRule.Wednesday"),key:3},{value:c.instant("bankRule.Thursday"),key:4},{value:c.instant("bankRule.Friday"),key:5},{value:c.instant("bankRule.Saturday"),key:6},{value:c.instant("bankRule.Sunday"),key:7}];m.workday=m.replenishRule.slice(0,5);m.count=[];m.amount=0;m.formParam={};m.init=function(){d("denominationList","system.denomination");n();if(l.id){e(l.id);m.$on("ngRepeatFinished",function(p){m.bankDetail.setValue(l.id)})}};function d(q,p){i.getDictListAsync(p).then(function(r){if(r.statusCode==="0000"){m[q]=r.data}})}function n(){m.showCheckBox=false;o.getBankTreeList().then(function(p){if(p.statusCode==="0000"){m.bankList=p.data}})}m.flagChecked=function(p,q){angular.forEach(p,function(r){r.checked=q})};m.bankDetailSelectCheck=function(p){};m.bankDetailSelectItem=function(p){m.select_all=false;m.select_workDay=false;m.flagChecked(m.replenishRule,false);e(p.id)};function e(p){f.getBankRule(p).then(function(q){if(q.statusCode==="0000"){m.formParam=q.data;var t=q.data.stockCeilings;for(var s=0;s<t.length;s++){for(var r=0;r<t[s]["denominationList"].length;r++){m.formParam.stockCeilings[s]["denominationList"][r]["dictDescs"]=t[s]["type"]+":"+m.formParam.stockCeilings[s]["denominationList"][r]["denomination"]}}h(m.formParam)}})}function h(p){var q=g.showData(p.replenishRule,m.replenishRule);m.select_all=q.selectAll;m.select_workDay=q.selectWorkDay;m.amount=0;angular.forEach(m.formParam.stockCeilings,function(r){angular.forEach(r.denominationList,function(s){m.amount+=parseFloat(s.denomination,10)*s.count})})}m.clear=function(p){k.close();b.go("app.bankRule",{},{reload:p})}}})();