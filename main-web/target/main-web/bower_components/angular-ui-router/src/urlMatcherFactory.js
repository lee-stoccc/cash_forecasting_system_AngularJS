var $$UMFP;function UrlMatcher(t,w,d){w=extend({params:{}},isObject(w)?w:{});var e=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,o=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,u="^",k=0,q,r=this.segments=[],j=d?d.params:{},v=this.params=d?d.params.$$new():new $$UMFP.ParamSet(),f=[];function c(x,p,m,i){f.push(x);if(j[x]){return j[x]}if(!/^\w+([-.]+\w+)*(?:\[\])?$/.test(x)){throw new Error("Invalid parameter name '"+x+"' in pattern '"+t+"'")}if(v[x]){throw new Error("Duplicate parameter name '"+x+"' in pattern '"+t+"'")}v[x]=new $$UMFP.Param(x,p,m,i);return v[x]}function a(x,z,y,p){var m=["",""],i=x.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!z){return i}switch(y){case false:m=["(",")"+(p?"?":"")];break;case true:i=i.replace(/\/$/,"");m=["(?:/(",")|/)?"];break;default:m=["("+y+"|",")?"];break}return i+m[0]+z+m[1]}this.source=t;function g(i,x){var C,B,A,z,p,y;C=i[2]||i[3];p=w.params[C];A=t.substring(k,i.index);B=x?i[4]:i[4]||(i[1]=="*"?".*":null);if(B){z=$$UMFP.type(B)||inherit($$UMFP.type("string"),{pattern:new RegExp(B,w.caseInsensitive?"i":undefined)})}return{id:C,regexp:B,segment:A,type:z,cfg:p}}var n,h,b;while((q=e.exec(t))){n=g(q,false);if(n.segment.indexOf("?")>=0){break}h=c(n.id,n.type,n.cfg,"path");u+=a(n.segment,h.type.pattern.source,h.squash,h.isOptional);r.push(n.segment);k=e.lastIndex}b=t.substring(k);var s=b.indexOf("?");if(s>=0){var l=this.sourceSearch=b.substring(s);b=b.substring(0,s);this.sourcePath=t.substring(0,k+s);if(l.length>0){k=0;while((q=o.exec(l))){n=g(q,true);h=c(n.id,n.type,n.cfg,"search");k=e.lastIndex}}}else{this.sourcePath=t;this.sourceSearch=""}u+=a(b)+(w.strict===false?"/?":"")+"$";r.push(b);this.regexp=new RegExp(u,w.caseInsensitive?"i":undefined);this.prefix=r[0];this.$$paramNames=f}UrlMatcher.prototype.concat=function(c,b){var a={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+c+this.sourceSearch,extend(a,b),this)};UrlMatcher.prototype.toString=function(){return this.source};UrlMatcher.prototype.exec=function(q,n){var d=this.regexp.exec(q);if(!d){return null}n=n||{};var a=this.parameters(),c=a.length,l=this.segments.length-1,p={},g,f,k,h;if(l!==d.length-1){throw new Error("Unbalanced capture group in route '"+this.source+"'")}function e(j){function s(t){return t.split("").reverse().join("")}function i(t){return t.replace(/\\-/g,"-")}var m=s(j).split(/-(?!\\)/);var r=map(m,s);return map(r,i).reverse()}var b,o;for(g=0;g<l;g++){h=a[g];b=this.params[h];o=d[g+1];for(f=0;f<b.replace.length;f++){if(b.replace[f].from===o){o=b.replace[f].to}}if(o&&b.array===true){o=e(o)}if(isDefined(o)){o=b.type.decode(o)}p[h]=b.value(o)}for(;g<c;g++){h=a[g];p[h]=this.params[h].value(n[h]);b=this.params[h];o=n[h];for(f=0;f<b.replace.length;f++){if(b.replace[f].from===o){o=b.replace[f].to}}if(isDefined(o)){o=b.type.decode(o)}p[h]=b.value(o)}return p};UrlMatcher.prototype.parameters=function(a){if(!isDefined(a)){return this.$$paramNames}return this.params[a]||null};UrlMatcher.prototype.validates=function(a){return this.params.$$validates(a)};UrlMatcher.prototype.format=function(a){a=a||{};var n=this.segments,t=this.parameters(),r=this.params;if(!this.validates(a)){return null}var q,e=false,o=n.length-1,p=t.length,g=n[0];function d(i){return encodeURIComponent(i).replace(/-/g,function(v){return"%5C%"+v.charCodeAt(0).toString(16).toUpperCase()})}for(q=0;q<p;q++){var h=q<o;var u=t[q],c=r[u],k=c.value(a[u]);var f=c.isOptional&&c.type.equals(c.value(),k);var s=f?c.squash:false;var b=c.type.encode(k);if(h){var m=n[q+1];var j=q+1===o;if(s===false){if(b!=null){if(isArray(b)){g+=map(b,d).join("-")}else{g+=encodeURIComponent(b)}}g+=m}else{if(s===true){var l=g.match(/\/$/)?/\/?(.*)/:/(.*)/;g+=m.match(l)[1]}else{if(isString(s)){g+=s+m}}}if(j&&c.squash===true&&g.slice(-1)==="/"){g=g.slice(0,-1)}}else{if(b==null||(f&&s!==false)){continue}if(!isArray(b)){b=[b]}if(b.length===0){continue}b=map(b,encodeURIComponent).join("&"+u+"=");g+=(e?"&":"?")+(u+"="+b);e=true}}return g};function Type(a){extend(this,a)}Type.prototype.is=function(b,a){return true};Type.prototype.encode=function(b,a){return b};Type.prototype.decode=function(b,a){return b};Type.prototype.equals=function(d,c){return d==c};Type.prototype.$subPattern=function(){var a=this.pattern.toString();return a.substr(1,a.length-2)};Type.prototype.pattern=/.*/;Type.prototype.toString=function(){return"{Type:"+this.name+"}"};Type.prototype.$normalize=function(a){return this.is(a)?a:this.decode(a)};Type.prototype.$asArray=function(b,a){if(!b){return this}if(b==="auto"&&!a){throw new Error("'auto' array mode is for query parameters only")}function c(g,i){function e(l,m){return function(){return l[m].apply(l,arguments)}}function k(l){return isArray(l)?l:(isDefined(l)?[l]:[])}function f(l){switch(l.length){case 0:return undefined;case 1:return i==="auto"?l[0]:l;default:return l}}function h(l){return !l}function d(n,m){return function l(p){if(isArray(p)&&p.length===0){return p}p=k(p);var o=map(p,n);if(m===true){return filter(o,h).length===0}return f(o)}}function j(m){return function l(q,p){var r=k(q),o=k(p);if(r.length!==o.length){return false}for(var n=0;n<r.length;n++){if(!m(r[n],o[n])){return false}}return true}}this.encode=d(e(g,"encode"));this.decode=d(e(g,"decode"));this.is=d(e(g,"is"),true);this.equals=j(e(g,"equals"));this.pattern=g.pattern;this.$normalize=d(e(g,"$normalize"));this.name=g.name;this.$arrayMode=i}return new c(this,b)};function $UrlMatcherFactory(){$$UMFP=this;var h=false,o=true,e=false;function j(q){return q!=null?q.toString().replace(/~/g,"~~").replace(/\//g,"~2F"):q}function n(q){return q!=null?q.toString().replace(/~2F/g,"/").replace(/~~/g,"~"):q}var k={},b=true,l=[],i,g={string:{encode:j,decode:n,is:function(q){return q==null||!isDefined(q)||typeof q==="string"},pattern:/[^/]*/},"int":{encode:j,decode:function(q){return parseInt(q,10)},is:function(q){return isDefined(q)&&this.decode(q.toString())===q},pattern:/\d+/},bool:{encode:function(q){return q?1:0},decode:function(q){return parseInt(q,10)!==0},is:function(q){return q===true||q===false},pattern:/0|1/},date:{encode:function(q){if(!this.is(q)){return undefined}return[q.getFullYear(),("0"+(q.getMonth()+1)).slice(-2),("0"+q.getDate()).slice(-2)].join("-")},decode:function(r){if(this.is(r)){return r}var q=this.capture.exec(r);return q?new Date(q[1],q[2]-1,q[3]):undefined},is:function(q){return q instanceof Date&&!isNaN(q.valueOf())},equals:function(r,q){return this.is(r)&&this.is(q)&&r.toISOString()===q.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,equals:angular.equals,pattern:/.*/}};function m(){return{strict:o,caseInsensitive:h}}function f(q){return(isFunction(q)||(isArray(q)&&isFunction(q[q.length-1])))}$UrlMatcherFactory.$$getDefaultValue=function(q){if(!f(q.value)){return q.value}if(!i){throw new Error("Injectable functions cannot be called at configuration time")}return i.invoke(q.value)};this.caseInsensitive=function(q){if(isDefined(q)){h=q}return h};this.strictMode=function(q){if(isDefined(q)){o=q}return o};this.defaultSquashPolicy=function(q){if(!isDefined(q)){return e}if(q!==true&&q!==false&&!isString(q)){throw new Error("Invalid squash policy: "+q+". Valid policies: false, true, arbitrary-string")}e=q;return q};this.compile=function(r,q){return new UrlMatcher(r,extend(m(),q))};this.isMatcher=function(r){if(!isObject(r)){return false}var q=true;forEach(UrlMatcher.prototype,function(t,s){if(isFunction(t)){q=q&&(isDefined(r[s])&&isFunction(r[s]))}});return q};this.type=function(q,r,s){if(!isDefined(r)){return k[q]}if(k.hasOwnProperty(q)){throw new Error("A type named '"+q+"' has already been defined.")}k[q]=new Type(extend({name:q},r));if(s){l.push({name:q,def:s});if(!b){c()}}return this};function c(){while(l.length){var q=l.shift();if(q.pattern){throw new Error("You cannot override a type's .pattern at runtime.")}angular.extend(k[q.name],i.invoke(q.def))}}forEach(g,function(r,q){k[q]=new Type(extend({name:q},r))});k=inherit(k,{});this.$get=["$injector",function(q){i=q;b=false;c();forEach(g,function(s,r){if(!k[r]){k[r]=new Type(s)}});return this}];this.Param=function a(s,C,w,E){var G=this;w=r(w);C=B(w,C,E);var z=q();C=z?C.$asArray(z,E==="search"):C;if(C.name==="string"&&!z&&E==="path"&&w.value===undefined){w.value=""}var x=w.value!==undefined;var y=A(w,x);var v=F(w,z,x,y);function r(H){var J=isObject(H)?objectKeys(H):[];var I=indexOf(J,"value")===-1&&indexOf(J,"type")===-1&&indexOf(J,"squash")===-1&&indexOf(J,"array")===-1;if(I){H={value:H}}H.$$fn=f(H.value)?H.value:function(){return H.value};return H}function B(I,J,H){if(I.type&&J){throw new Error("Param '"+s+"' has two type configurations.")}if(J){return J}if(!I.type){return(H==="config"?k.any:k.string)}if(angular.isString(I.type)){return k[I.type]}if(I.type instanceof Type){return I.type}return new Type(I.type)}function q(){var I={array:(E==="search"?"auto":false)};var H=s.match(/\[\]$/)?{array:true}:{};return extend(I,H,w).array}function A(I,H){var J=I.squash;if(!H||J===false){return false}if(!isDefined(J)||J==null){return e}if(J===true||isString(J)){return J}throw new Error("Invalid squash policy: '"+J+"'. Valid policies: false, true, or arbitrary string")}function F(K,J,I,N){var L,H,M=[{from:"",to:(I||J?undefined:"")},{from:null,to:(I||J?undefined:"")}];L=isArray(K.replace)?K.replace:[];if(isString(N)){L.push({from:N,to:undefined})}H=map(L,function(O){return O.from});return filter(M,function(O){return indexOf(H,O.from)===-1}).concat(L)}function u(){if(!i){throw new Error("Injectable functions cannot be called at configuration time")}var H=i.invoke(w.$$fn);if(H!==null&&H!==undefined&&!G.type.is(H)){throw new Error("Default value ("+H+") for parameter '"+G.id+"' is not an instance of Type ("+G.type.name+")")}return H}function D(J){function I(K){return function(L){return L.from===K}}function H(L){var K=map(filter(G.replace,I(L)),function(M){return M.to});return K.length?K[0]:L}J=H(J);return !isDefined(J)?u():G.type.$normalize(J)}function t(){return"{Param:"+s+" "+C+" squash: '"+y+"' optional: "+x+"}"}extend(this,{id:s,type:C,location:E,array:z,squash:y,replace:v,isOptional:x,value:D,dynamic:undefined,config:w,toString:t})};function d(q){extend(this,q||{})}d.prototype={$$new:function(){return inherit(this,extend(new d(),{$$parent:this}))},$$keys:function(){var s=[],q=[],r=this,t=objectKeys(d.prototype);while(r){q.push(r);r=r.$$parent}q.reverse();forEach(q,function(u){forEach(objectKeys(u),function(v){if(indexOf(s,v)===-1&&indexOf(t,v)===-1){s.push(v)}})});return s},$$values:function(s){var r={},q=this;forEach(q.$$keys(),function(t){r[t]=q[t].value(s&&s[t])});return r},$$equals:function(q,t){var s=true,r=this;forEach(r.$$keys(),function(v){var w=q&&q[v],u=t&&t[v];if(!r[v].type.equals(w,u)){s=false}});return s},$$validates:function p(u){var r=this.$$keys(),q,w,t,v,s;for(q=0;q<r.length;q++){w=this[r[q]];t=u[r[q]];if((t===undefined||t===null)&&w.isOptional){break}v=w.type.$normalize(t);if(!w.type.is(v)){return false}s=w.type.encode(v);if(angular.isString(s)&&!w.type.pattern.exec(s)){return false}}return true},$$parent:undefined};this.ParamSet=d}angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory);angular.module("ui.router.util").run(["$urlMatcherFactory",function(a){}]);