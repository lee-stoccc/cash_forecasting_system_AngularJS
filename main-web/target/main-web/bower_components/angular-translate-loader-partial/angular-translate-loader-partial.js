/*!
 * angular-translate - v2.11.1 - 2016-07-17
 * 
 * Copyright (c) 2016 The angular-translate team, Pascal Precht; Licensed MIT
 */
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(b())})}else{if(typeof exports==="object"){module.exports=b()}else{b()}}}(this,function(){angular.module("pascalprecht.translate").provider("$translatePartialLoader",a);function a(){function b(i,j){this.name=i;this.isActive=true;this.tables={};this.priority=j||0}b.prototype.parseUrl=function(j,i){if(angular.isFunction(j)){return j(this.name,i)}return j.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,i)};b.prototype.getTable=function(n,k,o,l,m,j){if(!this.tables[n]){var i=this;return o(angular.extend({method:"GET",url:this.parseUrl(m,n)},l)).then(function(p){i.tables[n]=p.data;return p.data},function(){if(j){return j(i.name,n).then(function(p){i.tables[n]=p;return p},function(){return k.reject(i.name)})}else{return k.reject(i.name)}})}else{return k.when(this.tables[n])}};var f={};function h(i){return Object.prototype.hasOwnProperty.call(f,i)}function e(i){return angular.isString(i)&&i!==""}function g(i){if(!e(i)){throw new TypeError("Invalid type of a first argument, a non-empty string expected.")}return(h(i)&&f[i].isActive)}function c(k,j){for(var i in j){if(j[i]&&j[i].constructor&&j[i].constructor===Object){k[i]=k[i]||{};c(k[i],j[i])}else{k[i]=j[i]}}return k}function d(){var j=[];for(var i in f){if(f[i].isActive){j.push(f[i])}}j.sort(function(l,k){return l.priority-k.priority});return j}this.addPart=function(i,j){if(!e(i)){throw new TypeError("Couldn't add part, part name has to be a string!")}if(!h(i)){f[i]=new b(i,j)}f[i].isActive=true;return this};this.setPart=function(k,i,j){if(!e(k)){throw new TypeError("Couldn't set part.`lang` parameter has to be a string!")}if(!e(i)){throw new TypeError("Couldn't set part.`part` parameter has to be a string!")}if(typeof j!=="object"||j===null){throw new TypeError("Couldn't set part. `table` parameter has to be an object!")}if(!h(i)){f[i]=new b(i);f[i].isActive=false}f[i].tables[k]=j;return this};this.deletePart=function(i){if(!e(i)){throw new TypeError("Couldn't delete part, first arg has to be string.")}if(h(i)){f[i].isActive=false}return this};this.isPartAvailable=g;this.$get=["$rootScope","$injector","$q","$http",function(j,l,k,m){var i=function(p){if(!e(p.key)){throw new TypeError("Unable to load data, a key is not a non-empty string.")}if(!e(p.urlTemplate)&&!angular.isFunction(p.urlTemplate)){throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string or not a function.")}var o=p.loadFailureHandler;if(o!==undefined){if(!angular.isString(o)){throw new Error("Unable to load data, a loadFailureHandler is not a string.")}else{o=l.get(o)}}var n=[],q=d();angular.forEach(q,function(r){n.push(r.getTable(p.key,k,m,p.$http,p.urlTemplate,o));r.urlTemplate=p.urlTemplate});return k.all(n).then(function(){var r={};q=d();angular.forEach(q,function(s){c(r,s.tables[p.key])});return r},function(){return k.reject(p.key)})};i.addPart=function(n,o){if(!e(n)){throw new TypeError("Couldn't add part, first arg has to be a string")}if(!h(n)){f[n]=new b(n,o);j.$emit("$translatePartialLoaderStructureChanged",n)}else{if(!f[n].isActive){f[n].isActive=true;j.$emit("$translatePartialLoaderStructureChanged",n)}}return i};i.deletePart=function(o,r){if(!e(o)){throw new TypeError("Couldn't delete part, first arg has to be string")}if(r===undefined){r=false}else{if(typeof r!=="boolean"){throw new TypeError("Invalid type of a second argument, a boolean expected.")}}if(h(o)){var p=f[o].isActive;if(r){var q=l.get("$translate");var n=q.loaderCache();if(typeof(n)==="string"){n=l.get(n)}if(typeof(n)==="object"){angular.forEach(f[o].tables,function(t,s){n.remove(f[o].parseUrl(f[o].urlTemplate,s))})}delete f[o]}else{f[o].isActive=false}if(p){j.$emit("$translatePartialLoaderStructureChanged",o)}}return i};i.isPartLoaded=function(n,o){return angular.isDefined(f[n])&&angular.isDefined(f[n].tables[o])};i.getRegisteredParts=function(){var n=[];angular.forEach(f,function(o){if(o.isActive){n.push(o.name)}});return n};i.isPartAvailable=g;return i}]}a.displayName="$translatePartialLoader";return"pascalprecht.translate"}));