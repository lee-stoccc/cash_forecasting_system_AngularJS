(function(){angular.module("devplatformApp").controller("RoleManagerConfigurationController",a);a.$inject=["RoleManagerConfigurationService","$state","paginationConstants","$scope","$stateParams","ngDialog","$timeout","PublicService","$uibModalInstance"];function a(f,v,r,n,y,l,A,h,q){n.roleList=[];n.totalFormList=[];n.formList=[];n.totalComponentList=[];n.componentList=[];n.checkMenuIdList=[];n.checkFormIdList=[];n.checkComponentIdList=[];n.showCheckBox=true;n.selectCheck=false;n.selectItem=k;n.selectCheck=e;n.selectComponent=b;n.checked_All_Form=false;n.checked_All_Component=false;n.checkedAllComponent=c;n.checkedComponent=x;n.checkedAllForm=z;n.checkedForm=d;n.saveRoleMenu=i;n.menuId=y.menuId;n.clear=m;if(!h.isEmptyObject(y.id)){u()}function u(){f.getAllSysRoleMenus({roleId:y.id}).then(function(C){if(C.statusCode==="0000"){n.roleList=C.data.menuList;n.totalFormList=C.data.formList;n.totalComponentList=C.data.componentList;j(n.roleList)}else{l.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(D){D.message=C.msgCode}]})}})}function k(D){n.formList=[];n.componentList=[];n.checked_All_Form=false;n.checked_All_Component=false;if(n.totalFormList===null){return}for(var C=0;C<n.totalFormList.length;C++){if(n.totalFormList[C]["id"]===D){n.formList=n.totalFormList[C]["list"];if(n.formList!==null&&n.formList.length>0){b(n.formList[0]["id"])}break}}}function b(D){n.checked_All_Component=false;n.componentList=[];if(n.totalComponentList===null){return}for(var C=0;C<n.totalComponentList.length;C++){if(n.totalComponentList[C]["id"]===D){n.componentList=n.totalComponentList[C]["list"];break}}}function j(E){if(E===null||E.length===0){return}n.formList=[];var D=E[0].children;if(D!==null&&D.length===0){var C=D[0].children;if(C!==null||C.length===0){k(C[0].id)}else{k(C.id)}}else{k(E[0].id)}}function e(C){for(var I=0;I<n.roleList.length;I++){if(String(n.roleList[I]["id"])===String(C)){var D=n.roleList[I]["children"];if(D!==null&&D.length>0){for(var E=0;E<D.length;E++){D[E]["checked"]=n.roleList[I]["checked"];e(D[E]["id"])}}else{o(n.roleList[I]["id"],n.roleList[I]["checked"])}return}var L=n.roleList[I].children;if(L!==null){for(var G=0;G<L.length;G++){if(String(L[G]["id"])===String(C)){var H=L[G]["children"];if(H!==null&&H.length>0){for(var K=0;K<H.length;K++){H[K]["checked"]=L[G]["checked"];e(H[K]["id"])}}else{if(L[G]["checked"]){s(L[G]["parentId"])}}return}var F=L[G].children;if(F!==null&&F.length>0){for(var J=0;J<F.length;J++){if(String(F[J]["id"])===String(C)){o(C,F[J]["checked"]);if(F[J]["checked"]){s(F[J]["parentId"])}return}}}}}}}function s(H){n.isFindMenuId=false;if(n.roleList===null||n.roleList.length===0){return}for(var D=0;D<n.roleList.length;D++){if(n.roleList[D]["id"]===H){n.roleList[D]["checked"]=true;return}var E=n.roleList[D]["children"];if(E===null||E.length===0){continue}for(var C=0;C<E.length;C++){if(E[C]["id"]===H){E[C]["checked"]=true;s(E[C]["parentId"]);return}var F=E[C]["children"];if(F===null||F.length===0){continue}for(var G=0;G<F.length;G++){if(F[G]["id"]===H){F[G]["checked"]=true;s(F[G]["parentId"]);return}}}}}function o(G,E){if(n.totalFormList===null||n.totalFormList.length===0){return}for(var D=0;D<n.totalFormList.length;D++){if(n.totalFormList[D]["id"]===G){var F=n.totalFormList[D]["list"];if(F===null||F.length===0){return}for(var C=0;C<F.length;C++){F[C]["checked"]=E;g(F[C]["id"],E)}}}}function z(){if(n.formList===null||n.formList.length===0){return}for(var C=0;C<n.formList.length;C++){n.formList[C]["checked"]=n.checked_All_Form;g(n.formList[C]["id"],n.checked_All_Form)}n.checked_All_Component=n.checked_All_Form;if(n.checked_All_Form){s(n.formList[0]["menuId"])}}function d(E,D,C){if(C){s(D)}else{n.checked_All_Form=false}if(n.componentList!==null&&n.componentList.length>0){if(n.componentList[0]["formId"]===E){n.checked_All_Component=C;c()}}}function t(D){if(n.formList===null||n.formList.length===0){return}for(var C=0;C<n.formList.length;C++){if(n.formList[C]["id"]===D){n.formList[C]["checked"]=true;break}}s(n.formList[C]["menuId"])}function g(G,F){if(n.totalComponentList===null||n.totalComponentList.length===0){return}for(var D=0;D<n.totalComponentList.length;D++){if(n.totalComponentList[D]["id"]===G){var E=n.totalComponentList[D]["list"];if(E===null||E.length===0){return}for(var C=0;C<E.length;C++){E[C]["checked"]=F}}}}function c(){if(n.componentList===null||n.componentList.length===0){return}for(var C=0;C<n.componentList.length;C++){n.componentList[C]["checked"]=n.checked_All_Component}if(n.checked_All_Component){t(n.componentList[0]["formId"])}}function x(D,C){if(C){t(D)}else{n.checked_All_Component=false}}function B(){n.checkMenuIdList=[];if(n.roleList!==null||n.roleList.length>0){for(var D=0;D<n.roleList.length;D++){if(n.roleList[D]["checked"]){n.checkMenuIdList.push(n.roleList[D]["id"])}var E=n.roleList[D]["children"];if(E!==null&&E.length>0){for(var C=0;C<E.length;C++){if(E[C]["checked"]){n.checkMenuIdList.push(E[C]["id"])}var F=E[C]["children"];if(F!==null&&F.length>0){for(var G=0;G<F.length;G++){if(F[G]["checked"]){n.checkMenuIdList.push(F[G]["id"])}}}}}}}}function w(){n.checkFormIdList=[];if(n.totalFormList!==null&&n.totalFormList.length>0){for(var D=0;D<n.totalFormList.length;D++){var E=n.totalFormList[D]["list"];if(E!==null&&E.length>0){for(var C=0;C<E.length;C++){if(E[C]["checked"]){n.checkFormIdList.push(E[C]["id"])}}}}}}function p(){n.checkComponentIdList=[];if(n.totalComponentList!==null&&n.totalComponentList.length>0){for(var D=0;D<n.totalComponentList.length;D++){var E=n.totalComponentList[D]["list"];if(E!==null&&E.length>0){for(var C=0;C<E.length;C++){if(E[C]["checked"]){n.checkComponentIdList.push(E[C]["id"])}}}}}}function i(){B();w();p();f.saveRolePrivilege({menuList:n.checkMenuIdList,formList:n.checkFormIdList,componentList:n.checkComponentIdList,roleId:y.id}).then(function(C){if(C.statusCode==="0000"){var D="devplatformApp.roleManagerConfiguration.success";n.showDialog(D)}else{var D=C.msgCode;n.showDialog(D)}})}n.showDialog=function(C){l.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(D){D.message=C}]});v.go("app.role-manager")};function m(C){q.close();v.go("app.role-manager",{},{reload:C})}}})();