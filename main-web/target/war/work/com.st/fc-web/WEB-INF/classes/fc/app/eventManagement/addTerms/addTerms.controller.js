(function(){angular.module("devplatformApp").controller("EventAddTermsController",a);a.$inject=["PublicService","SysDictService","EventManagementService","ngDialog","$state","$scope","$uibModalInstance","$stateParams"];function a(g,i,e,k,b,n,l,m){n.formParam={};n.clear=function(p){l.close();b.go("app.eventManagement",{},{reload:p})};n.loadAll=function(){n.refreshTableList(n.formParam)};n.save=function(){n.conflictTermsList=[{id:"123"},{id:"124"}];l.close();b.go("app.conflictImpact",{conflictImpacts:JSON.stringify(n.conflictTermsList)})};n.addTermsList=[];n.tablesConfig={showCheckBox:true,hideGo:true,checkOneAction:"checkOneAction",checkAllAction:"checkAllAction",itemsPerPage:6,tableTitles:[{title:"forecastReportform.bankName",filed:"bankName",type:"text",width:15},{title:"forecastReportform.region",filed:"region",type:"text",width:20},{title:"forecastReportform.regionName",filed:"regionName",type:"text",width:15},{title:"termInfo.branchNo",filed:"branchName",type:"text",width:20},{title:"termInfo.termNo",filed:"termNo",type:"text",width:15},{title:"eventManagement.effectValue",filed:"effectValue",type:"text",width:15}],url:"/api/actualEvent/pageTermForChoose",formParams:{bankName:n.formParam.bankName,regionName:n.formParam.regionName,branchName:n.formParam.branchNo,commercial:n.formParam.commercial}};n.checkOneAction=function(p){c(p)};n.checkAllAction=function(p){c(p)};function c(p){n.conflictTerms=[];if(p.length==0){return}angular.forEach(p,function(q){if(q.checked){q.ralatingEventId=m.id;n.conflictTerms.push(q)}})}n.init=function(){f();d("branchList","forecast.branch");d("commercialList","forecast.commercial");o();h()};function f(){var p={page_number:1,page_size:99999,formParams:{eventId:m.id}};e.getEventTermsList(p).then(function(q){if(q.statusCode==="0000"){n.addTermsList=q.data.list}})}function o(){e.getBankList().then(function(p){if(p.statusCode==="0000"){n.bankList=p.data}})}function d(q,p){i.getDictListAsync(p).then(function(r){if(r.statusCode==="0000"){n[q]=r.data}})}function h(){e.getCusgionList().then(function(p){if(p.statusCode==="0000"){n.cusgionList=p.data}})}function j(q){var p={conflictTerms:q};e.getConflictTermsList(p).then(function(r){if(r.statusCode==="0000"){n.addTermsList=r.data;if(n.addTermsList.length>0){l.close();b.go("app.conflictImpact",{conflictImpacts:n.addTermsList})}else{f();n.refreshTableList(n.formParam)}}})}}})();