(function(){angular.module("devplatformApp").controller("CreatePlanController",a);a.$inject=["PublicService","ForecastPlanService","ngDialog","$stateParams","$state","$scope","$uibModalInstance","SysDictService","$translate"];function a(f,k,h,j,b,l,i,g,d){l.formParam=[];l.bankList=[];l.formParam.forecastDate=new Date();l.datePickerOpenStatus={};l.clear=function(m){i.close();b.go("app.forecastPlan",{},{reload:m})};l.initView=function(){c();e("timePointList","forecast.timePoint");l.select("#bankName")};l.forecast=function(){i.close();f.openDialog("Please Wait...");var m=f.formatDate(l.formParam.forecastDate,"yyyy-MM-dd");k.createPlan(m,l.formParam.bankName,l.formParam.timePoint).then(function(n){if(n.statusCode==="0000"){var o="global.messages.forecastSuccess";f.openDialog(o);$(".ngdialog-theme-default").remove();l.clear(false)}else{var o="global.messages.forecastFail";f.openDialog(o);$(".ngdialog-theme-default").remove();l.clear(false)}})};l.select=function(m){angular.element(m).select2({placeholder:d.instant("global.pleaseSelect"),allowClear:true,tags:false})};l.loadAll=function(){l.refreshTableList(l.formParam)};function c(){l.showCheckBox=true;k.getBanksList().then(function(m){if(m.statusCode==="0000"){l.bankList=m.data}})}function e(n,m){g.getDictListAsync(m).then(function(o){if(o.statusCode==="0000"){l[n]=o.data;if(n=="timePointList"){l.formParam.timePoint=l[n][0]["dictKey"]}}})}l.openCalendar=function(m){l.datePickerOpenStatus[m]=true}}})();