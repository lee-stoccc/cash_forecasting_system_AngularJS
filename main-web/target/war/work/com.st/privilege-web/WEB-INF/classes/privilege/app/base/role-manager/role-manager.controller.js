(function(){angular.module("devplatformApp").controller("RoleManagerController",a);a.$inject=["$rootScope","PublicService","RoleManagerService","ngDialog","AlertService","$state","paginationConstants","$scope","$stateParams","$timeout","$translate"];function a(k,h,f,m,i,b,j,n,l,d,c){n.menuId=l.menuId;n.languages=null;n.resetSearch=e;n.roleManage=h.showView("roleManage");n.formParam={};n.choseArr=[];n.tablesConfig={showCheckBox:true,checkOneAction:"checkOneAction",checkAllAction:"checkAllAction",tableWidth:"table-default-width",tableTitles:[{title:"devplatformApp.sysRole.roleNo",filed:"roleNo",type:"text",width:8},{title:"devplatformApp.sysRole.roleName",filed:"roleName",type:"text",width:10},{title:"devplatformApp.sysRole.description",filed:"description",type:"text",width:"table-item-pre-2"},{title:"devplatformApp.sysRole.delFlag",filed:"delFlag",type:"btn-status",width:"table-item-pre-2",actions:[{actionName:"enableRole(item.id,item.delFlag)",statusList:[{status:"0",showName:"devplatformApp.sysRole.select.disabled"},{status:"1",showName:"devplatformApp.sysRole.select.enabled"}]}]},{title:"devplatformApp.sysRole.operation",filed:"operation",type:"btn",width:"table-item-pre-4",actions:[{actionName:"toEdit(item.id)",name:"entity.action.edit",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"editBtn"},{actionName:"toConfiguration(item.id)",name:"devplatformApp.sysRole.configuration",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"roleConfigBtn"},{actionName:"selectUser(item.id)",name:"devplatformApp.sysRole.assignUser",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"assignUserBtn"}]}],url:"api/sys-role/getAllSysRoles",formParams:{roleName:n.formParam.roleName,roleNo:n.formParam.roleNo,delFlag:n.formParam.delFlag,description:n.formParam.description}};n.loadAll=function(){n.refreshTableList(n.formParam)};n.checkOneAction=function(o){n.choseArr=[];angular.forEach(o,function(p){if(p.checked){n.choseArr.push(p)}})};n.checkAllAction=function(o){n.choseArr=[]};function e(){n.formParam={}}n.toEdit=function(o){b.go("app.role-manager-edit",{id:o,menuId:""})};n.toConfiguration=function(o){b.go("app.role-manager-configuration",{id:o,menuId:""})};function g(o){i.error("获取数据失败")}n.deleteSysRole=function(){n.choseArr=n.getCheckValues("delFlag").check;n.choseArrParam=n.getCheckValues("delFlag").checkedParamFlags;var p="";var o=false;if(n.choseArr[0]==""||n.choseArr.length==0){p="devplatformApp.sysRole.selectOne";o=true}else{if(n.choseArrParam.indexOf("1")!=-1){p="devplatformApp.sysRole.delDisabled";o=true}}if(o){m.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(q){q.message=p;q.type=""}]});return}n.message="devplatformApp.sysRole.delConfirm";n.type="confirm";m.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",scope:n,controller:["$scope",function(q){q.confirm=function(){f.deleteSysRole(q.checked).then(function(r){q.closeThisDialog();if(r.statusCode==="0000"){q.loadAll();p="global.deleteSuccess";h.openDialog(p)}})}}]})};n.showDialog=function(o){m.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(p){p.message=o;p.type=""}]});d(function(){m.close()},2000)};n.enableRole=function(p,o){if(o=="0"||o==null||o==undefined){n.message="devplatformApp.sysRole.enableConfirm";o="1"}else{if(o=="1"){n.message="devplatformApp.sysRole.disableConfirm";o="0"}}n.type="confirm";m.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",scope:n,controller:["$scope",function(q){q.confirm=function(){f.enableSysRole({roleId:p,delFlag:o}).then(function(r){if(r.statusCode==="0000"){q.loadAll()}});q.closeThisDialog()}}]})};n.selectUser=function(o){b.go("app.role-user",{sysRoleId:o})};k.$on("newRoleManager",function(o,p){n.loadAll()})}})();