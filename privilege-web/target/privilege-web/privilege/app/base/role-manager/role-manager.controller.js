(function(){angular.module("devplatformApp").controller("RoleManagerController",a);a.$inject=["PublicService","RoleManagerService","ngDialog","AlertService","$state","paginationConstants","$scope","$stateParams","$timeout","$translate"];function a(h,f,k,i,b,j,m,l,d,c){m.menuId=l.menuId;m.languages=null;m.resetSearch=e;m.roleManage=h.showView("roleManage");m.formParam={};m.tablesConfig={showCheckBox:true,tableWidth:"table-default-width",tableTitles:[{title:"devplatformApp.sysRole.roleNo",filed:"roleNo",type:"text",width:"table-item-pre-2"},{title:"devplatformApp.sysRole.roleName",filed:"roleName",type:"text",width:"table-item-pre-2"},{title:"devplatformApp.sysRole.description",filed:"description",type:"text",width:"table-item-pre-2"},{title:"devplatformApp.sysRole.delFlag",filed:"delFlag",type:"btn-status",width:"table-item-pre-2",actions:[{actionName:"enableRole(item.id,item.delFlag)",statusList:[{status:"0",showName:"devplatformApp.sysRole.select.disabled"},{status:"1",showName:"devplatformApp.sysRole.select.enabled"}]}]},{title:"devplatformApp.sysRole.operation",filed:"operation",type:"btn",width:"table-item-pre-4",actions:[{actionName:"toEdit(item.id)",name:"entity.action.edit",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"editBtn"},{actionName:"toConfiguration(item.id)",name:"devplatformApp.sysRole.configuration",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"roleConfigBtn"},{actionName:"selectUser(item.id)",name:"devplatformApp.sysRole.assignUser",disabled:"item.delFlag === '1'",formEnglishName:"roleManage",englishName:"assignUserBtn"}]}],url:"api/sys-role/getAllSysRoles",formParams:{roleName:m.formParam.roleName,roleNo:m.formParam.roleNo,delFlag:m.formParam.delFlag,description:m.formParam.description}};m.loadAll=function(){m.refreshTableList(m.formParam)};function e(){m.formParam={}}m.toEdit=function(n){b.go("app.role-manager-edit",{id:n,menuId:""})};m.toConfiguration=function(n){b.go("app.role-manager-configuration",{id:n,menuId:""})};function g(n){i.error("获取数据失败")}m.deleteSysRole=function(){m.choseArr=m.getCheckValues("delFlag").check;m.choseArrParam=m.getCheckValues("delFlag").checkedParamFlags;var o="";var n=false;if(m.choseArr[0]==""||m.choseArr.length==0){o="devplatformApp.sysRole.selectOne";n=true}else{if(m.choseArrParam.indexOf("1")!=-1){o="devplatformApp.sysRole.delDisabled";n=true}}if(n){k.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(p){p.message=o;p.type=""}]});return}m.message="devplatformApp.sysRole.delConfirm";m.type="confirm";k.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",scope:m,controller:["$scope",function(p){p.confirm=function(){f.deleteSysRole(p.checked).then(function(q){p.closeThisDialog();if(q.statusCode==="0000"){p.loadAll();o="global.deleteSuccess";h.openDialog(o)}})}}]})};m.showDialog=function(n){k.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",controller:["$scope",function(o){o.message=n;o.type=""}]});d(function(){k.close()},2000)};m.enableRole=function(o,n){if(n=="0"||n==null||n==undefined){m.message="devplatformApp.sysRole.enableConfirm";n="1"}else{if(n=="1"){m.message="devplatformApp.sysRole.disableConfirm";n="0"}}m.type="confirm";k.openConfirm({template:"app/common/dialog.html",className:"ngdialog-theme-default",scope:m,controller:["$scope",function(p){p.confirm=function(){f.enableSysRole({roleId:o,delFlag:n}).then(function(q){if(q.statusCode==="0000"){p.loadAll()}});p.closeThisDialog()}}]})};m.selectUser=function(n){b.go("app.role-user",{sysRoleId:n})}}})();