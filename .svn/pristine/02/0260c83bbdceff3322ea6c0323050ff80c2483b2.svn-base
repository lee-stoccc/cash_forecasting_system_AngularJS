(function(){angular.module("devplatformApp").controller("RoleManagerEditController",a);a.$inject=["PublicService","$timeout","$scope","$stateParams","RoleManagerService","$state","$compile","ngVerify","$uibModalInstance"];function a(j,d,n,m,f,b,g,c,l){n.menuId=m.menuId;n.clear=h;if(m.id){f.getSysRole(m.id).then(function(o){n.sysRole=o.data})}d(function(){angular.element(".form-group:eq(1)>input").focus()});n.save=function(){n.isSaving=true;if(n.sysRole.id!==null&&n.sysRole.id!==undefined){f.updateSysRole(n.sysRole).then(function(o){if(o.statusCode==="0000"){j.openDialog("global.saveSuccess");b.go("app.role-manager");n.isSaving=false}else{var p=o.msgCode;j.openDialog(p)}})}else{f.saveSysRole(n.sysRole).then(function(o){if(o.statusCode==="0000"){j.openDialog("global.saveSuccess");b.go("app.role-manager");n.isSaving=false;n.clear(true)}else{var p=o.msgCode;j.openDialog(p)}})}};var k=g(angular.element("<span style='color:red;font-size: 10px;' data-translate='devplatformApp.sysRole.regular'>编号只能为字母和数字，且长度为3到10</span>"))(n);var e=g(angular.element("<span style='color:red;font-size: 10px;' data-translate='{{repeatRoleNo}}'>该编号已存在，请重新输入</span>"))(n);var i=/^[a-zA-Z0-9]{3,10}$/;n.checkRoleNo=function(){n.isSaving=true;if(i.test(n.sysRole.roleNo)){if(k){k.remove()}f.checkRoleNo({roleNo:n.sysRole.roleNo}).then(function(o){if(o.data>0){n.repeatRoleNo=o.msgCode;angular.element("#roleNoDiv").append(e);angular.element("#roleNo").addClass("input-err");n.isSaving=true}else{if(o.data<=0){angular.element("#roleNo").removeClass("input-err");if(e){e.remove();n.isSaving=false}}}})}else{angular.element("#roleNoDiv").append(k);angular.element("#roleNo").addClass("input-err");if(e){e.remove()}}};function h(o){l.close();b.go("app.role-manager",{},{reload:o})}}})();