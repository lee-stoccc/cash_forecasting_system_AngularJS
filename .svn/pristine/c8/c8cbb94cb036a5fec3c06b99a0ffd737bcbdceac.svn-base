(function(){angular.module("devplatformApp").controller("FormEditController",a);a.$inject=["PublicService","$stateParams","MenuManagementService","$scope","$compile","ngVerify"];function a(i,k,j,l,f,d){if(l.formId){j.getFormById(l.formId).then(function(m){l.sysForm=m.data})}l.sysForm={menuId:k.menuFormId};l.saveForm=function(){l.isSaving=true;if(l.sysForm.id!==null&&l.sysForm.id!==undefined){j.updateSysForm(l.sysForm).then(function(m){var n="global.saveSuccess";i.openDialog(n);l.closeThisDialog()})}else{j.createSysForm(l.sysForm).then(function(m){var n="global.saveSuccess";i.openDialog(n);l.closeThisDialog()})}};var e=f(angular.element("<span style='color:red;font-size: 10px;' data-translate='devplatformApp.sysForm.onlyChinses'>只能输入中文</span>"))(l);var g=f(angular.element("<span style='color:red;font-size: 10px;' data-translate='devplatformApp.sysForm.onlyEnglish'>只能输入字母</span>"))(l);var h=f(angular.element("<span style='color:red;font-size: 10px;' data-translate='{{repeatFormEnglishName}}'>该名称已存在</span>"))(l);var c=/^[\u2E80-\u9FFF]{1,10}$/;var b=/^[a-zA-Z]{1,20}$/;l.checkFormName=function(){l.isSaving=true;if(c.test(l.sysForm.formName)){if(e){e.remove()}angular.element("#field_formName").removeClass("input-err");l.isSaving=false}else{angular.element("#formNameDiv").append(e);angular.element("#field_formName").addClass("input-err")}};l.checkEnglishName=function(){l.englishName=true;if(b.test(l.sysForm.englishName)){if(g){g.remove()}j.checkFormEnglishName({formEnglishName:l.sysForm.englishName}).then(function(m){if(m.data>0){l.repeatFormEnglishName=m.msgCode;angular.element("#englishNameDiv").append(h);angular.element("#field_englishName").addClass("input-err");l.englishName=true}else{if(m.data<=0){angular.element("#field_englishName").removeClass("input-err");if(h){h.remove();l.englishName=false}}}});angular.element("#field_englishName").removeClass("input-err")}else{angular.element("#englishNameDiv").append(g);angular.element("#field_englishName").addClass("input-err");if(h){h.remove()}}}}})();